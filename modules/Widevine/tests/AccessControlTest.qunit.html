<!DOCTYPE HTML>
<html>
<head>
	<title>Access Control Widevine vs</title>
	<script type="text/javascript" src="../../../tests/qunit/qunit-bootstrap.js"></script>
	<script type="text/javascript" src="../../../mwEmbedLoader.php"></script>
	<script type="text/javascript" src="../../../docs/js/doc-bootstrap.js"></script>
</head>
<body>
<h2> Access Control Widevine vs </h2>

This shows arbitrary custom access logic being applied to widevine content. <br><br>

Without VS:
<div id="player-without-vs" style="width:400px;height:330px;"></div>
<br>
With VS:
<div id="player-with-vs" style="width:400px;height:330px;"> loading ...</div>
<script>
	var settingsObj = {
		'wid': '_243342',
        "uiconf_id": 28671571,

        "cache_st": 1425999174,
        "entry_id": "1_9ln5whcm",

		'flashvars': {
			'flavorTags': 'widevine_mbr,mbr,web',
			'widevine': {
				'plugin': true
			}
		}
	};
	vWidget.embed('player-without-vs', settingsObj);
	$.getJSON('../../../services.php?service=VSTest&entry_id=1_9ln5whcm&wid=_243342', function (vsJSON) {
		if (!vsJSON || !vsJSON.vs) {
			$('#playerTarget').text('error getting vs');
			return;
		}
		settingsObj.flashvars.vs = vsJSON.vs;
		vWidget.embed('player-with-vs', settingsObj);
	});
</script>

<h3>Generating the VS request server side: </h3>
<pre class="prettyprint linenums">
&lt;?php
// Include the vidiun client available at: http://www.vidiun.com/api_v3/testme/client-libs.php
require_once(  '/vidiun_client_v3/VidiunClient.php' );

// setup your local config:
$partnerId = '929011';
$vidiunUserSecret = 'Your user secret is available in the settings tab in the VMC';
$entryId = '1_4f9zv9fu';

$conf = new VidiunConfiguration( $partnerId );
$conf->serviceUrl =	'https://cdnapisec.vidiun.com';
$conf->serviceBase =  '/api_v3/index.php?service=';

$client = new VidiunClient( $conf );

$vs = $client->session->start ( $vidiunUserSecret, 
	$_SERVER['REMOTE_ADDR'], 
	VidiunSessionType::USER, 
	$partnerId, 
	3600, // expire in one hour
	"sview:{$entryId}" // give permission to "view" the entry for the allocated time
);
// echo the VS out or return it to your embed logic,
echo $vs;
</pre>
<h3> Now take the VS and include in your embed: </h3>
<pre class="prettyprint linenums">
vWidget.embed('playerTargetId', {
	'wid': '_929011',
	'uiconf_id' : '16115322',
	'entry_id' : '1_4f9zv9fu',
	'flashvars':{
		'flavorTags' : 'widevine_mbr,mbr,web',
		'widevine': {
			'plugin': true
		},
		'vs': /* your generated sview vs goes here */
	}
});
</pre>
</body>
</html>